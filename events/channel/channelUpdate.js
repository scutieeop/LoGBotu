const { EmbedBuilder, ChannelType } = require('discord.js');module.exports = {  name: 'channelUpdate',  async execute(client, oldChannel, newChannel) {    if (!oldChannel.guild) return;    if (!client.config.logTypes.CHANNEL) return;    function guild_getChannelTypeString(type) {      const types = {        [ChannelType.GuildText]: 'Metin KanalÄ±',        [ChannelType.GuildVoice]: 'Ses KanalÄ±',        [ChannelType.GuildCategory]: 'Kategori',        [ChannelType.GuildAnnouncement]: 'Duyuru KanalÄ±',        [ChannelType.AnnouncementThread]: 'Duyuru Ä°ÅŸ ParÃ§acÄ±ÄŸÄ±',        [ChannelType.PublicThread]: 'Genel Ä°ÅŸ ParÃ§acÄ±ÄŸÄ±',        [ChannelType.PrivateThread]: 'Ã–zel Ä°ÅŸ ParÃ§acÄ±ÄŸÄ±',        [ChannelType.GuildStageVoice]: 'Sahne KanalÄ±',        [ChannelType.GuildForum]: 'Forum KanalÄ±',        [ChannelType.GuildDirectory]: 'Dizin KanalÄ±'      };      return types[type] || 'Bilinmeyen Kanal TÃ¼rÃ¼';    }    function guild_getChannelIcon(type) {      const icons = {        [ChannelType.GuildText]: 'ðŸ“',        [ChannelType.GuildVoice]: 'ðŸ”Š',        [ChannelType.GuildCategory]: 'ðŸ“',        [ChannelType.GuildAnnouncement]: 'ðŸ“¢',        [ChannelType.AnnouncementThread]: 'ðŸ§µ',        [ChannelType.PublicThread]: 'ðŸ§µ',        [ChannelType.PrivateThread]: 'ðŸ”’',        [ChannelType.GuildStageVoice]: 'ðŸŽ­',        [ChannelType.GuildForum]: 'ðŸ’¬',        [ChannelType.GuildDirectory]: 'ðŸ“š'      };      return icons[type] || 'â“';    }    async function guild_getAuditInfo(guild, channelId) {      try {        const fetchedLogs = await guild.fetchAuditLogs({          limit: 1,          type: 11         });        const log = fetchedLogs.entries.first();        if (log && log.target.id === channelId && (log.createdTimestamp > (Date.now() - 5000))) {          return {            executor: log.executor,            reason: log.reason          };        }        return {          executor: null,          reason: null        };      } catch (error) {        console.error('Audit log fetching error:', error);        return {          executor: null,          reason: null        };      }    }    if (oldChannel.name === newChannel.name &&        oldChannel.type === newChannel.type &&        oldChannel.topic === newChannel.topic &&        oldChannel.nsfw === newChannel.nsfw &&        oldChannel.parentId === newChannel.parentId &&        oldChannel.position === newChannel.position &&        oldChannel.rateLimitPerUser === newChannel.rateLimitPerUser &&        oldChannel.bitrate === newChannel.bitrate &&        oldChannel.userLimit === newChannel.userLimit) {      return;    }    const auditInfo = await guild_getAuditInfo(newChannel.guild, newChannel.id);    const channelType = guild_getChannelTypeString(newChannel.type);    const channelIcon = guild_getChannelIcon(newChannel.type);    const fields = [      { name: 'Kanal ID', value: newChannel.id, inline: true },      { name: 'Kanal TÃ¼rÃ¼', value: channelType, inline: true }    ];    if (oldChannel.name !== newChannel.name) {      fields.push({        name: 'Ä°sim DeÄŸiÅŸikliÄŸi',        value: `${oldChannel.name} â†’ ${newChannel.name}`,        inline: false      });    }    if (oldChannel.parentId !== newChannel.parentId) {      const oldParent = oldChannel.parent ? `${oldChannel.parent.name}` : 'Yok';      const newParent = newChannel.parent ? `${newChannel.parent.name}` : 'Yok';      fields.push({        name: 'Kategori DeÄŸiÅŸikliÄŸi',        value: `${oldParent} â†’ ${newParent}`,        inline: false      });    }    if (oldChannel.position !== newChannel.position) {      fields.push({        name: 'Pozisyon DeÄŸiÅŸikliÄŸi',        value: `${oldChannel.position} â†’ ${newChannel.position}`,        inline: false      });    }    if (oldChannel.type === ChannelType.GuildText || oldChannel.type === ChannelType.GuildAnnouncement) {      if (oldChannel.topic !== newChannel.topic) {        fields.push({          name: 'Konu DeÄŸiÅŸikliÄŸi',          value: `${oldChannel.topic || 'Yok'} â†’ ${newChannel.topic || 'Yok'}`,          inline: false        });      }      if (oldChannel.nsfw !== newChannel.nsfw) {        fields.push({          name: 'NSFW DeÄŸiÅŸikliÄŸi',          value: `${oldChannel.nsfw ? 'Evet' : 'HayÄ±r'} â†’ ${newChannel.nsfw ? 'Evet' : 'HayÄ±r'}`,          inline: false        });      }      if (oldChannel.rateLimitPerUser !== newChannel.rateLimitPerUser) {        const oldLimit = oldChannel.rateLimitPerUser ? `${oldChannel.rateLimitPerUser} saniye` : 'KapalÄ±';        const newLimit = newChannel.rateLimitPerUser ? `${newChannel.rateLimitPerUser} saniye` : 'KapalÄ±';        fields.push({          name: 'YavaÅŸ Mod DeÄŸiÅŸikliÄŸi',          value: `${oldLimit} â†’ ${newLimit}`,          inline: false        });      }    }    if ((oldChannel.type === ChannelType.GuildVoice || oldChannel.type === ChannelType.GuildStageVoice) &&        (newChannel.type === ChannelType.GuildVoice || newChannel.type === ChannelType.GuildStageVoice)) {      if (oldChannel.bitrate !== newChannel.bitrate) {        fields.push({          name: 'Bit HÄ±zÄ± DeÄŸiÅŸikliÄŸi',          value: `${oldChannel.bitrate / 1000}kbps â†’ ${newChannel.bitrate / 1000}kbps`,          inline: false        });      }      if (oldChannel.userLimit !== newChannel.userLimit) {        const oldLimit = oldChannel.userLimit || 'Limitsiz';        const newLimit = newChannel.userLimit || 'Limitsiz';        fields.push({          name: 'KullanÄ±cÄ± Limiti DeÄŸiÅŸikliÄŸi',          value: `${oldLimit} â†’ ${newLimit}`,          inline: false        });      }    }    if (auditInfo.executor) {      const formattedUser = await client.logger.guild_formatUser(auditInfo.executor);      fields.push({        name: 'DÃ¼zenleyen',        value: `<@${formattedUser.id}> (${formattedUser.name})`,        inline: true      });      if (auditInfo.reason) {        fields.push({          name: 'Sebep',          value: auditInfo.reason,          inline: false        });      }    }    await client.logger.guild_sendLog('channel', {      guildId: newChannel.guild.id,      title: `${channelIcon} Kanal GÃ¼ncellendi`,      description: `**${newChannel.name}** kanalÄ± gÃ¼ncellendi`,      color: client.config.colors.warning,      fields: fields,      footer: `${new Date().toLocaleString()}`,      username: `${newChannel.guild.name} - Kanal GÃ¼ncelleme`,      avatarURL: newChannel.guild.iconURL({ dynamic: true })    });  }}; 