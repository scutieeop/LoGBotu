const { EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, StringSelectMenuBuilder, StringSelectMenuOptionBuilder, ModalBuilder, TextInputBuilder, TextInputStyle, ComponentType, PermissionFlagsBits } = require('discord.js');module.exports = {  name: 'logalarm',  description: 'Ã–zel log alarmlarÄ± ve izleme kurallarÄ± oluÅŸturma ve yÃ¶netme',  async execute(message, args, client) {    if (!message.member.permissions.has(PermissionFlagsBits.Administrator)) {      return message.reply('Bu komutu kullanmak iÃ§in yÃ¶netici yetkisine sahip olmanÄ±z gerekiyor.');    }    const subCommand = args[0]?.toLowerCase();    if (!subCommand || subCommand === 'yardÄ±m') {      return showHelpMenu(message);    } else if (subCommand === 'oluÅŸtur' || subCommand === 'olustur' || subCommand === 'ekle') {      return createNewAlarm(message, args.slice(1), client);    } else if (subCommand === 'liste' || subCommand === 'alarmlar') {      return listAlarms(message, client);    } else if (subCommand === 'sil' || subCommand === 'kaldÄ±r' || subCommand === 'kaldir') {      return removeAlarm(message, args.slice(1), client);    } else if (subCommand === 'kullanÄ±cÄ±' || subCommand === 'kullanici' || subCommand === 'izle') {      return trackUser(message, args.slice(1), client);    } else if (subCommand === 'izlemeler') {      return listTrackedUsers(message, client);    } else if (subCommand === 'izlemekaldÄ±r' || subCommand === 'izlekaldir') {      return removeUserTracker(message, args.slice(1), client);    } else {      return message.reply('âŒ GeÃ§ersiz alt komut. YardÄ±m iÃ§in `.logalarm yardÄ±m` yazÄ±n.');    }  }};async function showHelpMenu(message) {  const embed = new EmbedBuilder()    .setTitle('ğŸ“¢ Log Alarm Sistemi')    .setDescription('Log kayÄ±tlarÄ± iÃ§in geliÅŸmiÅŸ izleme ve alarm sistemi. Belirli durumlarda bildirimler alÄ±n, kullanÄ±cÄ±larÄ± izleyin ve otomatik tepkiler oluÅŸturun.')    .setColor('#5865F2')    .addFields(      {        name: 'âš ï¸ Alarm YÃ¶netimi',        value: '`.logalarm oluÅŸtur` - Yeni bir log alarmÄ± oluÅŸturur\n'          + '`.logalarm liste` - Mevcut alarmlarÄ± listeler\n'          + '`.logalarm sil <alarm-id>` - Belirtilen alarmÄ± kaldÄ±rÄ±r',        inline: false      },      {        name: 'ğŸ‘ï¸ KullanÄ±cÄ± Ä°zleme',        value: '`.logalarm kullanÄ±cÄ± <@kullanÄ±cÄ±>` - Belirli bir kullanÄ±cÄ±yÄ± izlemeye alÄ±r\n'          + '`.logalarm izlemeler` - Ä°zlenen kullanÄ±cÄ±larÄ± listeler\n'          + '`.logalarm izlekaldir <@kullanÄ±cÄ±>` - KullanÄ±cÄ± izlemeyi kaldÄ±rÄ±r',        inline: false      },      {        name: 'ğŸ“‹ Alarm TÃ¼rleri',        value: '- Belirli bir kullanÄ±cÄ±nÄ±n tÃ¼m hareketleri\n'          + '- KÃ¼fÃ¼r/yasaklÄ± kelime kullanÄ±mÄ±\n'          + '- YÃ¶netici yetkisi alÄ±nmasÄ±/verilmesi\n'          + '- Belirli kanal/kategori izinlerinin deÄŸiÅŸtirilmesi\n'          + '- HÄ±zlÄ± mesaj silme iÅŸlemleri\n'          + '- Webhook oluÅŸturma/dÃ¼zenleme iÅŸlemleri\n'          + '- Toplu Ã¼ye hareketleri',        inline: false      }    )    .setFooter({ text: 'Discord Logger - GeliÅŸmiÅŸ Alarm Sistemi' });  return message.reply({ embeds: [embed] });}async function createNewAlarm(message, args, client) {  const alarmTypes = [    { value: 'user_action', label: 'ğŸ‘¤ KullanÄ±cÄ± Eylemi', description: 'Belirli bir kullanÄ±cÄ±nÄ±n herhangi bir eylemi' },    { value: 'message_content', label: 'ğŸ“ Mesaj Ä°Ã§eriÄŸi', description: 'Belirli kelime veya ifadeler iÃ§eren mesajlar' },    { value: 'role_change', label: 'ğŸ‘‘ Rol DeÄŸiÅŸimi', description: 'Belirli rollerle ilgili deÄŸiÅŸiklikler' },    { value: 'permission_change', label: 'ğŸ”’ Ä°zin DeÄŸiÅŸiklikleri', description: 'Kanal veya rol izinlerinde deÄŸiÅŸiklikler' },    { value: 'bulk_action', label: 'ğŸ—‘ï¸ Toplu Ä°ÅŸlemler', description: 'Toplu mesaj silme, toplu Ã¼ye atma gibi iÅŸlemler' },    { value: 'webhook_action', label: 'ğŸ”Œ Webhook Ä°ÅŸlemleri', description: 'Webhook oluÅŸturma, dÃ¼zenleme, silme iÅŸlemleri' }  ];  const notificationTypes = [    { value: 'channel', label: 'ğŸ“¢ Kanal Bildirimi', description: 'Belirli bir kanala bildirim gÃ¶nderir' },    { value: 'dm', label: 'âœ‰ï¸ Ã–zel Mesaj', description: 'Belirtilen kullanÄ±cÄ±lara Ã¶zel mesaj gÃ¶nderir' },    { value: 'auto_action', label: 'âš¡ Otomatik Tepki', description: 'Ban, kick, rol verme gibi otomatik tepkiler' }  ];  const alarmTypeMenu = new StringSelectMenuBuilder()    .setCustomId('alarm_type')    .setPlaceholder('Alarm tÃ¼rÃ¼nÃ¼ seÃ§in')    .addOptions(alarmTypes.map(type =>       new StringSelectMenuOptionBuilder()        .setLabel(type.label)        .setValue(type.value)        .setDescription(type.description)    ));  const row = new ActionRowBuilder().addComponents(alarmTypeMenu);  const initialEmbed = new EmbedBuilder()    .setTitle('ğŸš¨ Yeni Log AlarmÄ± OluÅŸtur')    .setDescription('Log sisteminiz iÃ§in yeni bir alarm oluÅŸturmak Ã¼zeresiniz. Bu alarm, belirli durumlarda bildirim almanÄ±za veya otomatik tepkiler oluÅŸturmanÄ±za yardÄ±mcÄ± olacaktÄ±r.\n\nLÃ¼tfen alarm tÃ¼rÃ¼nÃ¼ seÃ§in:')    .setColor('#5865F2')    .setFooter({ text: 'Ä°ptal etmek iÃ§in mesaja 30 saniye boyunca tepki vermeyin' });  const response = await message.reply({    embeds: [initialEmbed],    components: [row]  });  const collector = response.createMessageComponentCollector({    componentType: ComponentType.StringSelect,    time: 30000   });  collector.on('collect', async (interaction) => {    if (interaction.user.id !== message.author.id) {      return interaction.reply({        content: 'âŒ Bu menÃ¼yÃ¼ sadece komutu Ã§alÄ±ÅŸtÄ±ran kiÅŸi kullanabilir!',        ephemeral: true      });    }    collector.resetTimer();    const selectedAlarmType = interaction.values[0];    await showAlarmModal(interaction, selectedAlarmType, client, message);  });  collector.on('end', async (collected, reason) => {    if (reason === 'time' && collected.size === 0) {      await response.edit({        content: 'â±ï¸ Zaman aÅŸÄ±mÄ±: Alarm oluÅŸturma iÅŸlemi iptal edildi.',        embeds: [],        components: []      }).catch(() => {});    }  });}async function showAlarmModal(interaction, alarmType, client, message) {  const modal = new ModalBuilder()    .setCustomId(`alarm_modal_${alarmType}`)    .setTitle('Log AlarmÄ± OluÅŸtur');  if (alarmType === 'user_action') {    modal.addComponents(      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('user_id')          .setLabel('KullanÄ±cÄ± ID')          .setPlaceholder('Ä°zlenecek kullanÄ±cÄ±nÄ±n ID\'sini yazÄ±n')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('action_type')          .setLabel('Ä°ÅŸlem TÃ¼rÃ¼')          .setPlaceholder('mesaj, ses, rol deÄŸiÅŸikliÄŸi vb. (boÅŸ bÄ±rakÄ±labilir)')          .setStyle(TextInputStyle.Short)          .setRequired(false)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('notify_channel')          .setLabel('Bildirim KanalÄ± ID')          .setPlaceholder('Bildirimlerin gÃ¶nderileceÄŸi kanal ID')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('alarm_title')          .setLabel('Alarm BaÅŸlÄ±ÄŸÄ±')          .setPlaceholder('Alarm bildiriminde gÃ¶rÃ¼necek baÅŸlÄ±k')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('alarm_description')          .setLabel('Alarm AÃ§Ä±klamasÄ±')          .setPlaceholder('Alarm bildiriminde gÃ¶rÃ¼necek aÃ§Ä±klama')          .setStyle(TextInputStyle.Paragraph)          .setRequired(false)      )    );  } else if (alarmType === 'message_content') {    modal.addComponents(      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('content_pattern')          .setLabel('Aranacak Ä°Ã§erik')          .setPlaceholder('Mesajlarda aranacak kelime veya ifade')          .setStyle(TextInputStyle.Paragraph)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('notify_channel')          .setLabel('Bildirim KanalÄ± ID')          .setPlaceholder('Bildirimlerin gÃ¶nderileceÄŸi kanal ID')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('alarm_title')          .setLabel('Alarm BaÅŸlÄ±ÄŸÄ±')          .setPlaceholder('Alarm bildiriminde gÃ¶rÃ¼necek baÅŸlÄ±k')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('alarm_description')          .setLabel('Alarm AÃ§Ä±klamasÄ±')          .setPlaceholder('Alarm bildiriminde gÃ¶rÃ¼necek aÃ§Ä±klama')          .setStyle(TextInputStyle.Paragraph)          .setRequired(false)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('auto_action')          .setLabel('Otomatik Ä°ÅŸlem')          .setPlaceholder('delete - silme, warn - uyarÄ±, none - iÅŸlem yok')          .setStyle(TextInputStyle.Short)          .setRequired(false)      )    );  } else if (alarmType === 'role_change') {    modal.addComponents(      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('role_id')          .setLabel('Rol ID')          .setPlaceholder('Ä°zlenecek rolÃ¼n ID\'sini yazÄ±n')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('change_type')          .setLabel('DeÄŸiÅŸiklik TÃ¼rÃ¼')          .setPlaceholder('add, remove, update, permission (boÅŸ=tÃ¼mÃ¼)')          .setStyle(TextInputStyle.Short)          .setRequired(false)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('notify_channel')          .setLabel('Bildirim KanalÄ± ID')          .setPlaceholder('Bildirimlerin gÃ¶nderileceÄŸi kanal ID')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('alarm_title')          .setLabel('Alarm BaÅŸlÄ±ÄŸÄ±')          .setPlaceholder('Alarm bildiriminde gÃ¶rÃ¼necek baÅŸlÄ±k')          .setStyle(TextInputStyle.Short)          .setRequired(true)      ),      new ActionRowBuilder().addComponents(        new TextInputBuilder()          .setCustomId('alarm_description')          .setLabel('Alarm AÃ§Ä±klamasÄ±')          .setPlaceholder('Alarm bildiriminde gÃ¶rÃ¼necek aÃ§Ä±klama')          .setStyle(TextInputStyle.Paragraph)          .setRequired(false)      )    );  }  await interaction.showModal(modal);  try {    const modalResponse = await interaction.awaitModalSubmit({      time: 120000,       filter: i => i.customId.startsWith(`alarm_modal_`) && i.user.id === interaction.user.id    });    const alarmData = {};    if (alarmType === 'user_action') {      alarmData.userId = modalResponse.fields.getTextInputValue('user_id');      alarmData.actionType = modalResponse.fields.getTextInputValue('action_type');      const notifyChannelId = modalResponse.fields.getTextInputValue('notify_channel');      const alarmTitle = modalResponse.fields.getTextInputValue('alarm_title');      const alarmDescription = modalResponse.fields.getTextInputValue('alarm_description');      const pattern = {        logType: alarmData.actionType || null,        userId: alarmData.userId      };      const action = {        notifyChannelId,        title: alarmTitle,        description: alarmDescription,        color: '#FF5555'      };      const alarmId = client.logger.addAlarmPattern(pattern, action);      modalResponse.reply({        content: `âœ… KullanÄ±cÄ± eylemi alarmÄ± baÅŸarÄ±yla oluÅŸturuldu!\nAlarm ID: \`${alarmId}\`\nÄ°zlenen KullanÄ±cÄ±: <@${alarmData.userId}>\nBildirim KanalÄ±: <#${notifyChannelId}>`,        ephemeral: true      });    } else if (alarmType === 'message_content') {      const contentPattern = modalResponse.fields.getTextInputValue('content_pattern');      const notifyChannelId = modalResponse.fields.getTextInputValue('notify_channel');      const alarmTitle = modalResponse.fields.getTextInputValue('alarm_title');      const alarmDescription = modalResponse.fields.getTextInputValue('alarm_description');      const autoAction = modalResponse.fields.getTextInputValue('auto_action');      const pattern = {        logType: 'message',        content: contentPattern      };      const action = {        notifyChannelId,        title: alarmTitle,        description: alarmDescription,        color: '#FF5555',        autoActions: []      };      if (autoAction === 'delete') {        action.autoActions.push({          type: 'DELETE_MESSAGES',          amount: 1,          reason: 'YasaklÄ± iÃ§erik algÄ±landÄ±'        });      }      const alarmId = client.logger.addAlarmPattern(pattern, action);      modalResponse.reply({        content: `âœ… Mesaj iÃ§eriÄŸi alarmÄ± baÅŸarÄ±yla oluÅŸturuldu!\nAlarm ID: \`${alarmId}\`\nAranan Ä°Ã§erik: \`${contentPattern}\`\nBildirim KanalÄ±: <#${notifyChannelId}>${autoAction ? `\nOtomatik Ä°ÅŸlem: \`${autoAction}\`` : ''}`,        ephemeral: true      });    } else if (alarmType === 'role_change') {      const roleId = modalResponse.fields.getTextInputValue('role_id');      const changeType = modalResponse.fields.getTextInputValue('change_type');      const notifyChannelId = modalResponse.fields.getTextInputValue('notify_channel');      const alarmTitle = modalResponse.fields.getTextInputValue('alarm_title');      const alarmDescription = modalResponse.fields.getTextInputValue('alarm_description');      const pattern = {        logType: 'role',        roleId: roleId,        action: changeType || null      };      const action = {        notifyChannelId,        title: alarmTitle,        description: alarmDescription,        color: '#FF5555'      };      const alarmId = client.logger.addAlarmPattern(pattern, action);      modalResponse.reply({        content: `âœ… Rol deÄŸiÅŸikliÄŸi alarmÄ± baÅŸarÄ±yla oluÅŸturuldu!\nAlarm ID: \`${alarmId}\`\nÄ°zlenen Rol: <@&${roleId}>\nDeÄŸiÅŸiklik TÃ¼rÃ¼: ${changeType || 'TÃ¼mÃ¼'}\nBildirim KanalÄ±: <#${notifyChannelId}>`,        ephemeral: true      });    }    await message.channel.messages.fetch(interaction.message.id)      .then(msg => {        msg.edit({          content: 'âœ… Alarm baÅŸarÄ±yla oluÅŸturuldu! Detaylar Ã¶zel mesaj olarak gÃ¶nderildi.',          embeds: [],          components: []        });      })      .catch(() => {});  } catch (error) {    console.error('Modal yanÄ±t hatasÄ±:', error);    if (error.code === 'INTERACTION_COLLECTOR_ERROR') {      await message.channel.messages.fetch(interaction.message.id)        .then(msg => {          msg.edit({            content: 'â±ï¸ Zaman aÅŸÄ±mÄ±: Alarm oluÅŸturma iÅŸlemi iptal edildi.',            embeds: [],            components: []          });        })        .catch(() => {});    }  }}async function listAlarms(message, client) {  if (!client.logger.alarmPatterns || client.logger.alarmPatterns.size === 0) {    return message.reply('âŒ HenÃ¼z hiÃ§ alarm oluÅŸturulmamÄ±ÅŸ.');  }  const alarms = Array.from(client.logger.alarmPatterns.entries());  const itemsPerPage = 5;  const totalPages = Math.ceil(alarms.length / itemsPerPage);  let currentPage = 0;  const createPageContent = (page) => {    const startIdx = page * itemsPerPage;    const endIdx = Math.min(startIdx + itemsPerPage, alarms.length);    const pageAlarms = alarms.slice(startIdx, endIdx);    const embed = new EmbedBuilder()      .setTitle('ğŸš¨ Log AlarmlarÄ±')      .setDescription(`Sunucunuzda yapÄ±landÄ±rÄ±lmÄ±ÅŸ **${alarms.length}** alarm bulunmaktadÄ±r.`)      .setColor('#5865F2')      .setFooter({ text: `Sayfa ${page + 1}/${totalPages} â€¢ Toplam ${alarms.length} alarm` })      .setTimestamp();    pageAlarms.forEach(([alarmId, alarm], index) => {      const { pattern, action, enabled, created } = alarm;      let alarmType = 'ğŸ” Genel Alarm';      if (pattern.userId) alarmType = 'ğŸ‘¤ KullanÄ±cÄ± Eylemi';      else if (pattern.content) alarmType = 'ğŸ“ Mesaj Ä°Ã§eriÄŸi';      else if (pattern.roleId) alarmType = 'ğŸ‘‘ Rol DeÄŸiÅŸikliÄŸi';      else if (pattern.channelId) alarmType = 'ğŸ“¢ Kanal Ä°ÅŸlemi';      let summaryInfo = '';      if (pattern.userId) {        summaryInfo += `KullanÄ±cÄ±: <@${pattern.userId}>\n`;      }      if (pattern.logType) {        summaryInfo += `Log TÃ¼rÃ¼: \`${pattern.logType}\`\n`;      }      if (pattern.content) {        summaryInfo += `Ä°Ã§erik: \`${pattern.content}\`\n`;      }      if (pattern.roleId) {        summaryInfo += `Rol: <@&${pattern.roleId}>\n`;      }      if (pattern.channelId) {        summaryInfo += `Kanal: <#${pattern.channelId}>\n`;      }      if (action.notifyChannelId) {        summaryInfo += `Bildirim KanalÄ±: <#${action.notifyChannelId}>\n`;      }      if (action.notifyUserIds && action.notifyUserIds.length > 0) {        summaryInfo += `DM Bildirimleri: ${action.notifyUserIds.map(id => `<@${id}>`).join(', ')}\n`;      }      embed.addFields({        name: `${enabled ? 'âœ…' : 'âŒ'} ${alarmType} (ID: ${alarmId.substring(0, 8)}...)`,        value: summaryInfo + `OluÅŸturulma: <t:${Math.floor(new Date(created).getTime() / 1000)}:R>`,        inline: false      });    });    return embed;  };  const createButtons = () => {    return new ActionRowBuilder()      .addComponents(        new ButtonBuilder()          .setCustomId('prev_page')          .setLabel('â—€ï¸ Ã–nceki')          .setStyle(ButtonStyle.Secondary)          .setDisabled(currentPage === 0),        new ButtonBuilder()          .setCustomId('next_page')          .setLabel('Sonraki â–¶ï¸')          .setStyle(ButtonStyle.Secondary)          .setDisabled(currentPage === totalPages - 1),        new ButtonBuilder()          .setCustomId('delete_alarm')          .setLabel('ğŸ—‘ï¸ Alarm Sil')          .setStyle(ButtonStyle.Danger)      );  };  const response = await message.reply({    embeds: [createPageContent(currentPage)],    components: [createButtons()]  });  const collector = response.createMessageComponentCollector({    componentType: ComponentType.Button,    time: 60000   });  collector.on('collect', async (interaction) => {    if (interaction.user.id !== message.author.id) {      return interaction.reply({        content: 'âŒ Bu menÃ¼yÃ¼ sadece komutu Ã§alÄ±ÅŸtÄ±ran kiÅŸi kullanabilir!',        ephemeral: true      });    }    collector.resetTimer();    if (interaction.customId === 'prev_page') {      currentPage = Math.max(0, currentPage - 1);      await interaction.update({        embeds: [createPageContent(currentPage)],        components: [createButtons()]      });    }    else if (interaction.customId === 'next_page') {      currentPage = Math.min(totalPages - 1, currentPage + 1);      await interaction.update({        embeds: [createPageContent(currentPage)],        components: [createButtons()]      });    }    else if (interaction.customId === 'delete_alarm') {      const modal = new ModalBuilder()        .setCustomId('delete_alarm_modal')        .setTitle('Alarm Silme');      modal.addComponents(        new ActionRowBuilder().addComponents(          new TextInputBuilder()            .setCustomId('alarm_id')            .setLabel('Alarm ID')            .setPlaceholder('Silinecek alarmÄ±n ID\'sini yazÄ±n')            .setStyle(TextInputStyle.Short)            .setRequired(true)        )      );      await interaction.showModal(modal);      try {        const modalResponse = await interaction.awaitModalSubmit({          time: 60000,           filter: i => i.customId === 'delete_alarm_modal' && i.user.id === interaction.user.id        });        const alarmId = modalResponse.fields.getTextInputValue('alarm_id');        const found = Array.from(client.logger.alarmPatterns.keys()).find(id => id.startsWith(alarmId));        if (found) {          client.logger.alarmPatterns.delete(found);          modalResponse.reply({            content: `âœ… Alarm baÅŸarÄ±yla silindi: \`${found}\``,            ephemeral: true          });          const updatedAlarms = Array.from(client.logger.alarmPatterns.entries());          const updatedTotalPages = Math.ceil(updatedAlarms.length / itemsPerPage);          currentPage = Math.min(currentPage, updatedTotalPages - 1);          if (updatedAlarms.length === 0) {            await response.edit({              content: 'âŒ TÃ¼m alarmlar silindi.',              embeds: [],              components: []            });            collector.stop();          } else {            const createUpdatedPageContent = (page) => {              const startIdx = page * itemsPerPage;              const endIdx = Math.min(startIdx + itemsPerPage, updatedAlarms.length);              const pageAlarms = updatedAlarms.slice(startIdx, endIdx);              const embed = new EmbedBuilder()                .setTitle('ğŸš¨ Log AlarmlarÄ±')                .setDescription(`Sunucunuzda yapÄ±landÄ±rÄ±lmÄ±ÅŸ **${updatedAlarms.length}** alarm bulunmaktadÄ±r.`)                .setColor('#5865F2')                .setFooter({ text: `Sayfa ${page + 1}/${updatedTotalPages} â€¢ Toplam ${updatedAlarms.length} alarm` })                .setTimestamp();              pageAlarms.forEach(([alarmId, alarm], index) => {              });              return embed;            };            await response.edit({              embeds: [createUpdatedPageContent(currentPage)],              components: [createButtons()]            });          }        } else {          modalResponse.reply({            content: `âŒ \`${alarmId}\` ID'sine sahip bir alarm bulunamadÄ±.`,            ephemeral: true          });        }      } catch (error) {        console.error('Modal yanÄ±t hatasÄ±:', error);      }    }  });  collector.on('end', async () => {    const disabledButtons = new ActionRowBuilder()      .addComponents(        new ButtonBuilder()          .setCustomId('prev_page')          .setLabel('â—€ï¸ Ã–nceki')          .setStyle(ButtonStyle.Secondary)          .setDisabled(true),        new ButtonBuilder()          .setCustomId('next_page')          .setLabel('Sonraki â–¶ï¸')          .setStyle(ButtonStyle.Secondary)          .setDisabled(true),        new ButtonBuilder()          .setCustomId('delete_alarm')          .setLabel('ğŸ—‘ï¸ Alarm Sil')          .setStyle(ButtonStyle.Danger)          .setDisabled(true)      );    await response.edit({ components: [disabledButtons] }).catch(() => {});  });}async function removeAlarm(message, args, client) {  if (!args[0]) {    return message.reply('âŒ Silinecek alarmÄ±n ID\'sini belirtmelisiniz. AlarmlarÄ± listelemek iÃ§in `.logalarm liste` komutunu kullanÄ±n.');  }  const alarmId = args[0];  const found = Array.from(client.logger.alarmPatterns.keys()).find(id => id.startsWith(alarmId));  if (found) {    client.logger.alarmPatterns.delete(found);    return message.reply(`âœ… Alarm baÅŸarÄ±yla silindi: \`${found}\``);  } else {    return message.reply(`âŒ \`${alarmId}\` ID'sine sahip bir alarm bulunamadÄ±.`);  }}async function trackUser(message, args, client) {  const user = message.mentions.users.first() || client.users.cache.get(args[0]);  if (!user) {    return message.reply('âŒ Ä°zlenecek kullanÄ±cÄ±yÄ± etiketleyin veya ID\'sini yazÄ±n.');  }  let notifyChannelId = message.channel.id;  if (args[1]) {    const mentionedChannel = message.mentions.channels.first();    if (mentionedChannel) {      notifyChannelId = mentionedChannel.id;    } else if (args[1].match(/^\d+$/)) {      notifyChannelId = args[1];    }  }  const reason = args.slice(mentionedChannel ? 2 : 1).join(' ') || 'GÃ¼venlik izlemesi';  const result = client.logger.addUserTracker(user.id, {    notifyChannel: notifyChannelId,    reason: reason,    trackMessages: true,    trackVoice: true,    trackMember: true  });  if (result) {    return message.reply(`âœ… <@${user.id}> kullanÄ±cÄ±sÄ± izlemeye alÄ±ndÄ±. Bildirimler <#${notifyChannelId}> kanalÄ±na gÃ¶nderilecek.\nNeden: ${reason}`);  } else {    return message.reply('âŒ KullanÄ±cÄ± izleme eklenirken bir hata oluÅŸtu.');  }}async function listTrackedUsers(message, client) {  if (!client.logger.userTracker || client.logger.userTracker.size === 0) {    return message.reply('âŒ HenÃ¼z hiÃ§ kullanÄ±cÄ± izlemeye alÄ±nmamÄ±ÅŸ.');  }  const trackedUsers = Array.from(client.logger.userTracker.entries());  const embed = new EmbedBuilder()    .setTitle('ğŸ‘ï¸ Ä°zlenen KullanÄ±cÄ±lar')    .setDescription(`Sunucunuzda **${trackedUsers.length}** kullanÄ±cÄ± izleniyor.`)    .setColor('#FF5555')    .setTimestamp();  trackedUsers.forEach(([userId, tracker]) => {    embed.addFields({      name: `${tracker.enabled ? 'ğŸ”´' : 'âšª'} <@${userId}>`,      value: `BaÅŸlangÄ±Ã§: <t:${Math.floor(new Date(tracker.startedAt).getTime() / 1000)}:R>\nNeden: ${tracker.reason}\nÄ°zlenenler: ${tracker.trackMessages ? 'ğŸ“' : ''} ${tracker.trackVoice ? 'ğŸ”Š' : ''} ${tracker.trackMember ? 'ğŸ‘¤' : ''}\nKayÄ±t SayÄ±sÄ±: ${tracker.logs.length}`,      inline: true    });  });  return message.reply({ embeds: [embed] });}async function removeUserTracker(message, args, client) {  const user = message.mentions.users.first() || client.users.cache.get(args[0]);  if (!user) {    return message.reply('âŒ Ä°zlemesi kaldÄ±rÄ±lacak kullanÄ±cÄ±yÄ± etiketleyin veya ID\'sini yazÄ±n.');  }  const result = client.logger.removeUserTracker(user.id);  if (result) {    return message.reply(`âœ… <@${user.id}> kullanÄ±cÄ±sÄ±nÄ±n izlemesi kaldÄ±rÄ±ldÄ±.`);  } else {    return message.reply(`âŒ <@${user.id}> kullanÄ±cÄ±sÄ± zaten izlenmiyor.`);  }} 